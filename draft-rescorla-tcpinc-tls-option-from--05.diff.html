<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.34: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Darwin EKRs-MacBook-Pro.local 14.5.0 Darwin Kernel Version 14.5.0: Wed Jul 29 02:26:53 PDT 2015; root:xnu-2782.40.9~1/RELEASE_X86_64 x86_64 --> 
<!-- Using awk: /opt/local/bin//gawk: GNU Awk 4.1.3, API: 1.1 --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 2.8.1 --> 
<!-- Using wdiff: /opt/local/bin//wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-rescorla-tcpinc-tls-option-05.txt - draft-rescorla-tcpinc-tls-option.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
  </style> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr bgcolor="orange"><th></th><th>&nbsp;draft-rescorla-tcpinc-tls-option-05.txt&nbsp;</th><th> </th><th>&nbsp;draft-rescorla-tcpinc-tls-option.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">TCPING                                                       E. Rescorla</td><td> </td><td class="right">TCPING                                                       E. Rescorla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Internet-Draft                                                   Mozilla</td><td> </td><td class="right">Internet-Draft                                                   Mozilla</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0001" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Intended status: Standards Track                        October <span class="delete">19,</span> 2015</td><td> </td><td class="rblock">Intended status: Standards Track                        October <span class="insert">21,</span> 2015</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">Expires: April <span class="delete">21,</span> 2016</td><td> </td><td class="rblock">Expires: April <span class="insert">23,</span> 2016</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                           TCP Use TLS Option</td><td> </td><td class="right">                           TCP Use TLS Option</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0002" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                <span class="delete">  draft-rescorla-tcpinc-tls-option-05</span></td><td> </td><td class="rblock">                <span class="insert">draft-rescorla-tcpinc-tls-option-latest</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document defines the use of TLS [RFC5246] with the TCP-ENO</td><td> </td><td class="right">   This document defines the use of TLS [RFC5246] with the TCP-ENO</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   option [I-D.bittau-tcpinc-tcpeno].</td><td> </td><td class="right">   option [I-D.bittau-tcpinc-tcpeno].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This Internet-Draft is submitted in full conformance with the</td><td> </td><td class="right">   This Internet-Draft is submitted in full conformance with the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provisions of BCP 78 and BCP 79.</td><td> </td><td class="right">   provisions of BCP 78 and BCP 79.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l2" /><small>skipping to change at</small><em> page 1, line 31</em></th><th> </th><th><a name="part-r2" /><small>skipping to change at</small><em> page 1, line 31</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Drafts is at http://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at http://datatracker.ietf.org/drafts/current/.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0003" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   This Internet-Draft will expire on April 2<span class="delete">1</span>, 2016.</td><td> </td><td class="rblock">   This Internet-Draft will expire on April 2<span class="insert">3</span>, 2016.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Copyright (c) 2015 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2015 IETF Trust and the persons identified as the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Provisions Relating to IETF Documents</td><td> </td><td class="right">   Provisions Relating to IETF Documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   (http://trustee.ietf.org/license-info) in effect on the date of</td><td> </td><td class="right">   (http://trustee.ietf.org/license-info) in effect on the date of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   publication of this document.  Please review these documents</td><td> </td><td class="right">   publication of this document.  Please review these documents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   carefully, as they describe your rights and restrictions with respect</td><td> </td><td class="right">   carefully, as they describe your rights and restrictions with respect</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to this document.  Code Components extracted from this document must</td><td> </td><td class="right">   to this document.  Code Components extracted from this document must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   include Simplified BSD License text as described in Section 4.e of</td><td> </td><td class="right">   include Simplified BSD License text as described in Section 4.e of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the Trust Legal Provisions and are provided without warranty as</td><td> </td><td class="right">   the Trust Legal Provisions and are provided without warranty as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   described in the Simplified BSD License.</td><td> </td><td class="right">   described in the Simplified BSD License.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2</td><td> </td><td class="right">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0004" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   2.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   <span class="delete">2</span></td><td> </td><td class="rblock">   2.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   3.  <span class="delete">TLS Profile</span> . . . . . . . . . . . . . . . . . . . . . . . . .   3</td><td> </td><td class="rblock">   3.  <span class="insert">TCP-ENO Binding . . . . . . . .</span> . . . . . . . . . . . . . . .   <span class="insert">3</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     <span class="delete">3.1.  TLS 1.3 Profile</span> . . . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="rblock"><span class="insert">     3.1.  Suboption Definition  . . . . . . . .</span> . . . . . . . . . .   3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">3.1.1.  Handshake Modes</span> . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="rblock">     <span class="insert">3.2.  Session ID  . .</span> . . . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">       <span class="delete">3.1.2.  Basic 1-RTT Handshake</span> . . . . . . . . . . . . . . . .   <span class="delete">5</span></td><td> </td><td class="rblock">     <span class="insert">3.3.  Channel Close . . .</span> . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       3.1.3.  Hello Retry Request [6.3.1.3]</span> . . . . . . . . . . . .   <span class="delete">8</span></td><td> </td><td class="rblock">   <span class="insert">4.  TLS Profile</span> . . . . . . . . . . . . . . . . . . . . . . . . .   <span class="insert">4</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       3.1.4.  Zero-RTT Exchange</span> . . . . . . . . . . . . . . . . . .   <span class="delete">9</span></td><td> </td><td class="rblock"><span class="insert">     4.1.  TLS 1.3 Profile</span> . . . . . . . . . . . . . . . . . . . . .   <span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       3.1.5.  Key Schedule</span>  . . . . . . . . . . . . . . . . . . . .  <span class="delete">10</span></td><td> </td><td class="rblock"><span class="insert">       4.1.1.  Handshake Modes .</span> . . . . . . . . . . . . . . . . . .   <span class="insert">5</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">       3.1.6.  Record Protection</span> . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock"><span class="insert">       4.1.2.  Basic 1-RTT Handshake</span> . . . . . . . . . . . . . . . .   <span class="insert">6</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.2.  TLS 1.2 Profile</span> . . . . . . . . . . . . . . . . . . . . .  <span class="delete">11</span></td><td> </td><td class="rblock"><span class="insert">       4.1.3.  Hello Retry Request [6.3.1.3]</span> . . . . . . . . . . . .  <span class="insert">10</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.3.  Deprecated Features</span> . . . . . . . . . . . . . . . . . . .  12</td><td> </td><td class="rblock"><span class="insert">       4.1.4.  Zero-RTT Exchange</span> . . . . . . . . . . . . . <span class="insert">. . . . .  10</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">     <span class="delete">3.4.  Session ID</span>  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock"><span class="insert">       4.1.5.  Key Schedule  .</span> . . . . . . . . . . . . . . . . . . .  12</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     3.5.  Cryptographic Algorithms</span>  . . . . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock">       <span class="insert">4.1.6.  Record Protection</span> . . . . . . . . . . . . . . . . . .  <span class="insert">13</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   4.  Suboption Definition</span>  . . . . . . . . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock"><span class="insert">     4.2.  TLS 1.2 Profile</span> . . . . . . . . . . . . . . . . . . . . .  <span class="insert">13</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   5.  Transport Integrity . . . . . . . . . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock"><span class="insert">     4.3.  Deprecated Features</span> . . . . . . . . . . . . . . . . . . .  <span class="insert">14</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   6.  <span class="delete">Implementation Options</span>  . . . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock"><span class="insert">     4.4.  Cryptographic Algorithms</span>  . <span class="insert">. . . . . . . . . . . . . . .  14</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   7.  NAT/Firewall considerations . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">   5.  Transport Integrity . . . . . . . . . . . . . . . . . . . . .  <span class="insert">14</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   8.</span>  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">   6.  <span class="insert">API Considerations</span>  . . . . . . . . . . . . . . . . . . . <span class="insert">. .  15</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   9.</span>  Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">14</span></td><td> </td><td class="rblock">   7.  <span class="insert">Implementation Considerations . . . . . . . . . . . . . . . .  15</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   10.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">14</span></td><td> </td><td class="rblock"><span class="insert">   8.</span>  NAT/Firewall considerations . . . . . . . . . . . . . . . . .  <span class="insert">15</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     10.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">14</span></td><td> </td><td class="rblock"><span class="insert">   9.</span>  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">15</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">     10.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">16</span></td><td> </td><td class="rblock"><span class="insert">   10.</span> Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">16</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   11.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">16</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     11.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">16</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     11.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">18</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td> </td><td class="right">   RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td> </td><td class="right">   draft is maintained in GitHub.  Suggested changes should be submitted</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   as pull requests at https://github.com/ekr/tcpinc-tls.  Instructions</td><td> </td><td class="right">   as pull requests at https://github.com/ekr/tcpinc-tls.  Instructions</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   are on that page as well.</td><td> </td><td class="right">   are on that page as well.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TCPINC WG is chartered to define protocols to provide ubiquitous,</td><td> </td><td class="right">   The TCPINC WG is chartered to define protocols to provide ubiquitous,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transparent security for TCP connections.  The WG is specifying The</td><td> </td><td class="right">   transparent security for TCP connections.  The WG is specifying The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l3" /><small>skipping to change at</small><em> page 3, line 8</em></th><th> </th><th><a name="part-r3" /><small>skipping to change at</small><em> page 3, line 16</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The basic idea behind this draft is simple.  The SYN and SYN/ACK</td><td> </td><td class="right">   The basic idea behind this draft is simple.  The SYN and SYN/ACK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages carry the TCP-ENO options indicating the willingness to do</td><td> </td><td class="right">   messages carry the TCP-ENO options indicating the willingness to do</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS.  If both sides want to do TLS, then a TLS handshake is started</td><td> </td><td class="right">   TLS.  If both sides want to do TLS, then a TLS handshake is started</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and once that completes, the data is TLS protected prior to being</td><td> </td><td class="right">   and once that completes, the data is TLS protected prior to being</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sent over TCP.  Otherwise, the application data is sent as usual.</td><td> </td><td class="right">   sent over TCP.  Otherwise, the application data is sent as usual.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Client                                    Server</td><td> </td><td class="right">            Client                                    Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            SYN + TCP-ENO [TLS]-&gt;</td><td> </td><td class="right">            SYN + TCP-ENO [TLS]-&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0005" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                  &lt;- SYN/ACK + TCP-ENO <span class="delete">[ENO]</span></td><td> </td><td class="rblock">                                      &lt;- SYN/ACK + TCP-ENO <span class="insert">[TLS]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            ACK -&gt;</td><td> </td><td class="rblock">                ACK <span class="insert">+ TCP-ENO</span> -&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;---------------- TLS Handshake ---------------&gt;</td><td> </td><td class="right">            &lt;---------------- TLS Handshake ---------------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            &lt;--------- Application Data over TLS ----------&gt;</td><td> </td><td class="right">            &lt;--------- Application Data over TLS ----------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0006" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                 <span class="delete">Figure 1: Negotiating TLS with TCP-TLS</span></td><td> </td><td class="rblock">                 <span class="insert">                Figure 1</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            Client                                    Server</td><td> </td><td class="right">            Client                                    Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            SYN + TCP-ENO [TLS] -&gt;</td><td> </td><td class="right">            SYN + TCP-ENO [TLS] -&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                  &lt;- SYN/ACK</td><td> </td><td class="right">                                                  &lt;- SYN/ACK</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            ACK -&gt;</td><td> </td><td class="right">            ACK -&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0007" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">            <span class="delete">&lt;--------- Application Data over TLS</span> ----------&gt;</td><td> </td><td class="rblock">            <span class="insert">    &lt;--------- Application Data over TCP</span> ----------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                      Figure 2: Fall back to TCP</td><td> </td><td class="right">                      Figure 2: Fall back to TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If use of TLS is negotiated, the data sent over TCP simply is TLS</td><td> </td><td class="right">   If use of TLS is negotiated, the data sent over TCP simply is TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   data in compliance with TLS 1.2 [RFC5246] or TLS 1.3</td><td> </td><td class="right">   data in compliance with TLS 1.2 [RFC5246] or TLS 1.3</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.ietf-tls-tls13].</td><td> </td><td class="right">   [I-D.ietf-tls-tls13].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the TLS handshake has completed, all application data SHALL be</td><td> </td><td class="right">   Once the TLS handshake has completed, all application data SHALL be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sent over that negotiated TLS channel.  Application data MUST NOT be</td><td> </td><td class="right">   sent over that negotiated TLS channel.  Application data MUST NOT be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sent prior to the TLS handshake.</td><td> </td><td class="right">   sent prior to the TLS handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0008" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   If the TLS handshake <span class="delete">fails for non-cryptographic reasons such as</span></td><td> </td><td class="rblock">   If the TLS handshake <span class="insert">fails,</span> the <span class="insert">endpoint MUST tear down</span> the <span class="insert">TCP</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   failure to negotiate a compatible cipher or</span> the <span class="delete">like, endpoints</span></td><td> </td><td class="rblock">   connection and <span class="insert">MUST NOT send plaintext data over</span> the <span class="insert">connection.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   SHOULD behave as if</span> the <span class="delete">the TCP-TLS option was not present.  This is</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   obviously not the conventional behavior for TLS failure, but as the</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   entire idea here is to be opportunistic and the attacker can simply</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   suppress the TCP-TLS option entirely, this provides the maximum</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   robustness against broken intermediaries.  If the TLS handshake fails</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   for cryptographic reasons that indicate damage to the datastream</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   (e.g., a decryption failure or a Finished failure) then the endpoints</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   SHOULD signal a</span> connection <span class="delete">failure, as this suggests that there is a</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   middlebox modifying the data</span> and <span class="delete">there is a reasonable chance that</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the <span class="delete">state is now corrupted.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0009" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">3.  TLS Profile</td><td> </td><td class="rblock">3.  <span class="insert">TCP-ENO Binding</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">3.1.  Suboption Definition</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TCP-ENO suboption with cs value set to [TBD].  Specifically, this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   means that the SYN contains a 1-byte suboption indicating support for</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   this specification.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       bit   7   6   5   4   3   2   1   0</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">           +---+---+---+---+---+---+---+---+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">           | 0 |           TBD             |</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">           +---+---+---+---+---+---+---+---+</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [[OPEN ISSUE: It would be nice to indicate the desire to have 0-RTT,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   but that would require a variable length suboption, which seems</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   perhaps excessive.  Maybe that's the right answer anyway.]]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The SYN/ACK can be in one of two forms:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  A 1-byte suboption as in the SYN.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  A variable-length suboption.  In this case, the remainder of the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      option contains a nonce to be used for 0-RTT (see Section 4.1.4.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      This nonce MUST be globally unique.  Servers MUST NOT use this</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      form of the suboption unless explicitly configured (see</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      Section 6).  [[OPEN ISSUE: I just thought this up recently, so</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      it's possible it's totally half-baked and won't work.  In</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      particular, am I chewing up too much option space?]]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The ACK simply contains the bare TCP-ENO suboption.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">3.2.  Session ID</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TCP-ENO Section 4.1 defines a session ID feature (not to be confused</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with TLS Session IDs).  When the protocol in use is TLS, the session</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ID is computed via a TLS Exporter [RFC5705] using the Exporter Label</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [[TBD]] and without a context value (the TCP-ENO transcript is</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   incorporated via the TCPENOTranscript extension).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">3.3.  Channel Close</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Because TLS security is provided in the TCP transport stream rather</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   than at the segment level, the FIN is not an authenticated indicator</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of end of data.  Instead implementations following this specification</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   MUST send a TLS close_notify alert prior to sending a FIN and MUST</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   raise an error if a FIN or RST is receive prior to receiving a</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   close_notify.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4.</span>  TLS Profile</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The TLS Profile defined in this document is intended to be a</td><td> </td><td class="right">   The TLS Profile defined in this document is intended to be a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   compromise between two separate use cases.  For the straight TCPINC</td><td> </td><td class="right">   compromise between two separate use cases.  For the straight TCPINC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   use case of ubiquitous transport encryption, we desire that</td><td> </td><td class="right">   use case of ubiquitous transport encryption, we desire that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   implementations solely implement TLS 1.3 [I-D.ietf-tls-tls13] or</td><td> </td><td class="right">   implementations solely implement TLS 1.3 [I-D.ietf-tls-tls13] or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   greater.  However, we also want to allow the use of TCP-ENO as a</td><td> </td><td class="right">   greater.  However, we also want to allow the use of TCP-ENO as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   signal for applications to do out-of-band negotiation of TLS, and</td><td> </td><td class="right">   signal for applications to do out-of-band negotiation of TLS, and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   those applications are likely to already have support for TLS 1.2</td><td> </td><td class="right">   those applications are likely to already have support for TLS 1.2</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5246].  In order to accomodate both cases, we specify a wire</td><td> </td><td class="right">   [RFC5246].  In order to accomodate both cases, we specify a wire</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   encoding that allows for negotiation of multiple TLS versions</td><td> </td><td class="right">   encoding that allows for negotiation of multiple TLS versions</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0010" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (Section <span class="delete">4)</span> but encourage implementations to implement only TLS 1.3.</td><td> </td><td class="rblock">   (Section <span class="insert">3.1)</span> but encourage implementations to implement only TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Implementations which also implement TLS 1.2 MUST implement the</td><td> </td><td class="rblock">   1.3.  Implementations which also implement TLS 1.2 MUST implement the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   profile described in Section <span class="delete">3.2</span></td><td> </td><td class="rblock">   profile described in Section <span class="insert">4.2</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0011" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.  TLS 1.3 Profile</td><td> </td><td class="rblock"><span class="insert">4</span>.1.  TLS 1.3 Profile</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 is the preferred version of TLS for this specification.  In</td><td> </td><td class="right">   TLS 1.3 is the preferred version of TLS for this specification.  In</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   order to facilitate implementation, this section provides a non-</td><td> </td><td class="right">   order to facilitate implementation, this section provides a non-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   normative description of the parts of TLS 1.3 which are relevant to</td><td> </td><td class="right">   normative description of the parts of TLS 1.3 which are relevant to</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0012" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TCPINC and defines a baseline of algorithms and modes which MUST be</td><td> </td><td class="rblock">   TCPINC and defines a <span class="insert">normative</span> baseline of algorithms and modes which</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   supported.  Other modes, cipher suites, key exchange algorithms,</td><td> </td><td class="rblock">   MUST be supported.  Other modes, cipher suites, key exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   certificate formats as defined in [I-D.ietf-tls-tls13] MAY also be</td><td> </td><td class="rblock">   algorithms, certificate formats as defined in [I-D.ietf-tls-tls13]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   used and that document remains the normative reference for TLS 1.3.</td><td> </td><td class="rblock">   MAY also be used and that document remains the normative reference</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Bracketed references (e.g., [S. 1.2.3.4] refer to the corresponding</td><td> </td><td class="rblock">   for TLS 1.3.  Bracketed references (e.g., [S. 1.2.3.4] refer to the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   section in that document.)  In order to match TLS terminology, we use</td><td> </td><td class="rblock">   corresponding section in that document.)  In order to match TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the term "client" to indicate the TCP-ENO "A" role (See</td><td> </td><td class="rblock">   terminology, we use the term "client" to indicate the TCP-ENO "A"</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [I-D.bittau-tcpinc-tcpeno]; Section 3.1) and "server" to indicate the</td><td> </td><td class="rblock">   role (See [I-D.bittau-tcpinc-tcpeno]; Section 3.1) and "server" to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   "B" role.</td><td> </td><td class="rblock">   indicate the "B" role.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0013" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.1.  Handshake Modes</td><td> </td><td class="rblock"><span class="insert">4</span>.1.1.  Handshake Modes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 as used in TCPINC supports two handshake modes, both based on</td><td> </td><td class="right">   TLS 1.3 as used in TCPINC supports two handshake modes, both based on</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0014" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   E<span class="delete">CDHE</span> key exchange.</td><td> </td><td class="rblock">   E<span class="insert">lliptic Curve Diffie-Hellman Ephemeral (ECDHE)</span> key exchange.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  A 1-RTT mode which is used when the client has no information</td><td> </td><td class="right">   o  A 1-RTT mode which is used when the client has no information</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0015" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      about the server's keying material (see Figure <span class="delete">1</span>)</td><td> </td><td class="rblock">      about the server's keying material (see Figure <span class="insert">3</span>)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  A 0-RTT mode which is used when the client and server have</td><td> </td><td class="right">   o  A 0-RTT mode which is used when the client and server have</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      connected previous and which allows the client to send data on the</td><td> </td><td class="right">      connected previous and which allows the client to send data on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0016" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      first flight (see Figure <span class="delete">2</span></td><td> </td><td class="rblock">      first flight (see Figure <span class="insert">4)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0017" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   In both case, the server is expected to have an <span class="delete">ECDSA</span> signing key</td><td> </td><td class="rblock">   In both case, the server is expected to have an <span class="insert">Elliptic-Curve</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   which may either be a freshly-generated key or a long-term key</td><td> </td><td class="rblock"><span class="insert">   Digital Signature Algorithm (ECDSA)</span> signing key which may either be a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   (allowing <span class="delete">TOFU-style</span> applications).  The key need not be associated</td><td> </td><td class="rblock">   freshly-generated key or a long-term key (allowing <span class="insert">Trust-On-First-Use</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   with any certificate and can simply be a bare key.</td><td> </td><td class="rblock"><span class="insert">   (TOFU) style</span> applications).  The key need not be associated with any</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   certificate and can simply be a bare key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Full TLS 1.3 includes support for additional modes based on pre-</td><td> </td><td class="right">   Full TLS 1.3 includes support for additional modes based on pre-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   shared keys, but TCPINC implementations MAY opt to omit them.</td><td> </td><td class="right">   shared keys, but TCPINC implementations MAY opt to omit them.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST implement the 1-RTT mode and SHOULD implement</td><td> </td><td class="right">   Implementations MUST implement the 1-RTT mode and SHOULD implement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the 0-RTT mode.</td><td> </td><td class="right">   the 0-RTT mode.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        Client                                               Server</td><td> </td><td class="right">        Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        ClientHello</td><td> </td><td class="right">        ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0018" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          + ClientKeyShare        <span class="delete">--------&gt;</span></td><td> </td><td class="rblock">          + ClientKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">          <span class="insert">+ TCPENOTranscript      -------&gt;</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                        ServerHello</td><td> </td><td class="right">                                                        ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                     ServerKeyShare</td><td> </td><td class="right">                                                     ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                              {EncryptedExtensions}</td><td> </td><td class="right">                                              {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                             {ServerConfiguration*}</td><td> </td><td class="right">                                             {ServerConfiguration*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                      {Certificate}</td><td> </td><td class="right">                                                      {Certificate}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                {CertificateVerify}</td><td> </td><td class="right">                                                {CertificateVerify}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                  &lt;--------              {Finished}</td><td> </td><td class="right">                                  &lt;--------              {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0019" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                  &lt;--------      [Application Data]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        {Finished}                --------&gt;</td><td> </td><td class="right">        {Finished}                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">        [Application Data]        &lt;-------&gt;      [Application Data]</td><td> </td><td class="right">        [Application Data]        &lt;-------&gt;      [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               *  Indicates optional or situation-dependent</td><td> </td><td class="right">               *  Indicates optional or situation-dependent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  messages that are not always sent.</td><td> </td><td class="right">                  messages that are not always sent.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               {} Indicates messages protected using keys</td><td> </td><td class="right">               {} Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  derived from the ephemeral secret.</td><td> </td><td class="right">                  derived from the ephemeral secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               [] Indicates messages protected using keys</td><td> </td><td class="right">               [] Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  derived from the master secret.</td><td> </td><td class="right">                  derived from the master secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0020" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">               Figure <span class="delete">1</span>: Message flow for full TLS Handshake</td><td> </td><td class="rblock">               Figure <span class="insert">3</span>: Message flow for full TLS Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Note: Although these diagrams indicate a message called</td><td> </td><td class="right">   Note: Although these diagrams indicate a message called</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "Certificate", this message MAY either contain a bare public key or</td><td> </td><td class="right">   "Certificate", this message MAY either contain a bare public key or</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an X.509 certificate (this is intended to support the out-of-band use</td><td> </td><td class="right">   an X.509 certificate (this is intended to support the out-of-band use</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   case indicated above).  Implementations MUST support bare public keys</td><td> </td><td class="right">   case indicated above).  Implementations MUST support bare public keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and MAY support X.509 certificates.</td><td> </td><td class="right">   and MAY support X.509 certificates.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0021" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.2.  Basic 1-RTT Handshake</td><td> </td><td class="rblock"><span class="insert">4</span>.1.2.  Basic 1-RTT Handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0022" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.2.1.  Client's First Flight</td><td> </td><td class="rblock"><span class="insert">4</span>.1.2.1.  Client's First Flight</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0023" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.2.1.1.  Sending</td><td> </td><td class="rblock"><span class="insert">4</span>.1.2.1.1.  Sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to initiate the TLS handshake, the client sends a</td><td> </td><td class="right">   In order to initiate the TLS handshake, the client sends a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "ClientHello" message [S. 6.3.1.1].</td><td> </td><td class="right">   "ClientHello" message [S. 6.3.1.1].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       struct {</td><td> </td><td class="right">       struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           ProtocolVersion client_version = { 3, 4 };    /* TLS v1.3 */</td><td> </td><td class="right">           ProtocolVersion client_version = { 3, 4 };    /* TLS v1.3 */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           Random random;</td><td> </td><td class="right">           Random random;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           uint8 session_id_len_RESERVED;                /* Must be zero */</td><td> </td><td class="right">           uint8 session_id_len_RESERVED;                /* Must be zero */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           CipherSuite cipher_suites&lt;2..2^16-2&gt;;</td><td> </td><td class="right">           CipherSuite cipher_suites&lt;2..2^16-2&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           uint8 compression_methods_len_RESERVED;       /* Must be zero */</td><td> </td><td class="right">           uint8 compression_methods_len_RESERVED;       /* Must be zero */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l4" /><small>skipping to change at</small><em> page 6, line 35</em></th><th> </th><th><a name="part-r4" /><small>skipping to change at</small><em> page 7, line 45</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShare [S. 6.3.2.3]</td><td> </td><td class="right">   ClientKeyShare [S. 6.3.2.3]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Zero or more ECDHE shares drawn from the groups in NamedGroup.</td><td> </td><td class="right">      Zero or more ECDHE shares drawn from the groups in NamedGroup.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      This SHOULD contain either a P-256 key or an X25519 key.</td><td> </td><td class="right">      This SHOULD contain either a P-256 key or an X25519 key.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The client MUST also include a ServerCertTypeExtension containing</td><td> </td><td class="right">   The client MUST also include a ServerCertTypeExtension containing</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   type "Raw Public Key" [RFC7250], indicating its willingness to accept</td><td> </td><td class="right">   type "Raw Public Key" [RFC7250], indicating its willingness to accept</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   a raw public key rather than an X.509 certificate in the server's</td><td> </td><td class="right">   a raw public key rather than an X.509 certificate in the server's</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Certificate message.</td><td> </td><td class="right">   Certificate message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0024" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.2.1.2.</span>  Receiving</td><td> </td><td class="rblock">   <span class="insert">The client MUST include a TCPENOTranscript extension containing the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TCP-ENO options that were used to negotiate ENO.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4.1.2.2.  The TCPENOTranscript</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   TCPENOTranscript TLS Extension is used to carry the TCP ENO</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   negotiation transcript.  The body of the extension simply includes</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the TCP-ENO negotiation transcript as defined in TCP-ENO Section 3.4.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This serves two purposes:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  It binds the TCP-ENO negotiation into the TLS handshake.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  In 0-RTT mode (see Section 4.1.4) it allows the server to provide</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      an anti-replay nonce which is then mixed into the TLS handshake.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The server MUST validate that the TCPENOTranscript extension matches</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the transcript.  If not, it MUST fail the handshake with a fatal</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   "handshake_failure" exception.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4.1.2.2.1.</span>  Receiving</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receiving the client's ClientHello, the server selects a</td><td> </td><td class="right">   Upon receiving the client's ClientHello, the server selects a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ciphersuite and ECDHE group out of the lists provided by the client</td><td> </td><td class="right">   ciphersuite and ECDHE group out of the lists provided by the client</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in the cipher_suites list and the NamedGroup extension.  If the</td><td> </td><td class="right">   in the cipher_suites list and the NamedGroup extension.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client supplied an appropriate ClientKeyShare for that group, then</td><td> </td><td class="right">   client supplied an appropriate ClientKeyShare for that group, then</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0025" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   the server responds with a ServerHello (see <span class="delete">{{server-first-flight).</span></td><td> </td><td class="rblock">   the server responds with a ServerHello (see <span class="insert">Section 4.1.2.3).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Otherwise, it replies with a HelloRetryRequest (Section <span class="delete">3.1.3),</span></td><td> </td><td class="rblock">   Otherwise, it replies with a HelloRetryRequest (Section <span class="insert">4.1.3),</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   indicating that the client needs to re-send the ClientHello with an</td><td> </td><td class="right">   indicating that the client needs to re-send the ClientHello with an</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   appropriate key share; because all TCPINC implementations are</td><td> </td><td class="right">   appropriate key share; because all TCPINC implementations are</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   required to support P-256, this should not happen unless P-256 is</td><td> </td><td class="right">   required to support P-256, this should not happen unless P-256 is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   deprecated by a subsequent specification.</td><td> </td><td class="right">   deprecated by a subsequent specification.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0026" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.2.2</span>.  Server's First Flight</td><td> </td><td class="rblock"><span class="insert">4.1.2.3</span>.  Server's First Flight</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0027" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.2.2</span>.1.  Sending</td><td> </td><td class="rblock"><span class="insert">4.1.2.3</span>.1.  Sending</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0028" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   The server respond<span class="delete">'</span>s to the client's first flight with a sequence of</td><td> </td><td class="rblock">   The server responds to the client's first flight with a sequence of</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   messages:</td><td> </td><td class="right">   messages:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerHello [6.3.1.2]</td><td> </td><td class="right">   ServerHello [6.3.1.2]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Contains a nonce and the cipher suite that the server has selected</td><td> </td><td class="right">      Contains a nonce and the cipher suite that the server has selected</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      out of the client's list.  The server MUST support the extensions</td><td> </td><td class="right">      out of the client's list.  The server MUST support the extensions</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0029" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      listed in Section <span class="delete">3</span>.1.2.1.1 and MUST also ignore any extensions it</td><td> </td><td class="rblock">      listed in Section <span class="insert">4</span>.1.2.1.1 and MUST also ignore any extensions it</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      does not recognize; this implies that the server can implement</td><td> </td><td class="right">      does not recognize; this implies that the server can implement</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0030" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      solely the extensions listed in Section <span class="delete">3</span>.1.2.1.1.</td><td> </td><td class="rblock">      solely the extensions listed in Section <span class="insert">4</span>.1.2.1.1.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerKeyShare [6.3.3]</td><td> </td><td class="right">   ServerKeyShare [6.3.3]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Contains the server's ECDHE share for one of the groups offered in</td><td> </td><td class="right">      Contains the server's ECDHE share for one of the groups offered in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the client's ClientKeyShare message.  All messages after</td><td> </td><td class="right">      the client's ClientKeyShare message.  All messages after</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ServerKeyShare are encrypted using keys derived from the</td><td> </td><td class="right">      ServerKeyShare are encrypted using keys derived from the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      ClientKeyShare and ServerKeyShare.</td><td> </td><td class="right">      ClientKeyShare and ServerKeyShare.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   EncryptedExtensions [6.3.4]</td><td> </td><td class="right">   EncryptedExtensions [6.3.4]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Responses to the extensions offered by the client.  In this case,</td><td> </td><td class="right">      Responses to the extensions offered by the client.  In this case,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the only relevant extension is the ServerCertTypeExtension.</td><td> </td><td class="right">      the only relevant extension is the ServerCertTypeExtension.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l5" /><small>skipping to change at</small><em> page 7, line 40</em></th><th> </th><th><a name="part-r5" /><small>skipping to change at</small><em> page 9, line 16</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      The server's certificate.  If the client offered a "Raw Public</td><td> </td><td class="right">      The server's certificate.  If the client offered a "Raw Public</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Key" type in ServerCertTypeExtension this message SHALL contain a</td><td> </td><td class="right">      Key" type in ServerCertTypeExtension this message SHALL contain a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      SubjectPublicKeyInfo value for the server's key as specified in</td><td> </td><td class="right">      SubjectPublicKeyInfo value for the server's key as specified in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      [RFC7250].  Otherwise, it SHALL contain one or more X.509</td><td> </td><td class="right">      [RFC7250].  Otherwise, it SHALL contain one or more X.509</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      Certificates, as specified in [I-D.ietf-tls-tls13], Section 6.3.5.</td><td> </td><td class="right">      Certificates, as specified in [I-D.ietf-tls-tls13], Section 6.3.5.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      In either case, this message MUST contain a key which is</td><td> </td><td class="right">      In either case, this message MUST contain a key which is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      consistent with the client's SignatureAlgorithms and NamedGroup</td><td> </td><td class="right">      consistent with the client's SignatureAlgorithms and NamedGroup</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      extensions.</td><td> </td><td class="right">      extensions.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ServerConfiguration [6.3.7]</td><td> </td><td class="right">   ServerConfiguration [6.3.7]</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0031" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      A server configuration value for use in 0-RTT (see Section <span class="delete">3</span>.1.4).</td><td> </td><td class="rblock">      A server configuration value for use in 0-RTT (see Section <span class="insert">4</span>.1.4).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   CertificateVerify [6.3.8]</td><td> </td><td class="right">   CertificateVerify [6.3.8]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A signature over the handshake transcript using the key provided</td><td> </td><td class="right">      A signature over the handshake transcript using the key provided</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      in the certificate message.</td><td> </td><td class="right">      in the certificate message.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finished [6.3.9]</td><td> </td><td class="right">   Finished [6.3.9]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      A MAC over the entire handshake transcript up to this point.</td><td> </td><td class="right">      A MAC over the entire handshake transcript up to this point.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the server has sent the Finished message, it can immediately</td><td> </td><td class="right">   Once the server has sent the Finished message, it can immediately</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   generate the application traffic keys and start sending application</td><td> </td><td class="right">   generate the application traffic keys and start sending application</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic to the client.</td><td> </td><td class="right">   traffic to the client.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0032" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.2.3</span>.  Receiving</td><td> </td><td class="rblock"><span class="insert">4.1.2.4</span>.  Receiving</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Upon receiving the server's first flight, the client proceeds as</td><td> </td><td class="right">   Upon receiving the server's first flight, the client proceeds as</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   follows:</td><td> </td><td class="right">   follows:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Read the ServerHello message to determine the cryptographic</td><td> </td><td class="right">   o  Read the ServerHello message to determine the cryptographic</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      parameters.</td><td> </td><td class="right">      parameters.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Read the ServerKeyShare message and use that in combination with</td><td> </td><td class="right">   o  Read the ServerKeyShare message and use that in combination with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the ClientKeyShare to compute the keys which are used to encrypt</td><td> </td><td class="right">      the ClientKeyShare to compute the keys which are used to encrypt</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      the rest of the handshake.</td><td> </td><td class="right">      the rest of the handshake.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l6" /><small>skipping to change at</small><em> page 8, line 35</em></th><th> </th><th><a name="part-r6" /><small>skipping to change at</small><em> page 10, line 11</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Read the server's CertificateVerify message and verify the</td><td> </td><td class="right">   o  Read the server's CertificateVerify message and verify the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      server's signature over the handshake transcript.  If the</td><td> </td><td class="right">      server's signature over the handshake transcript.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      signature does not verify, the client terminates the handshake</td><td> </td><td class="right">      signature does not verify, the client terminates the handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      with an alert (Section 6.1.2).</td><td> </td><td class="right">      with an alert (Section 6.1.2).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Read the server's Finished message and verify the finished MAC</td><td> </td><td class="right">   o  Read the server's Finished message and verify the finished MAC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      based on the DH shared secret.  If the MAC does not verify, the</td><td> </td><td class="right">      based on the DH shared secret.  If the MAC does not verify, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      client terminates the handshake with an alert.</td><td> </td><td class="right">      client terminates the handshake with an alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0033" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.2.4</span>.  Client's Second Flight</td><td> </td><td class="rblock"><span class="insert">4.1.2.5</span>.  Client's Second Flight</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Finally, the client sends a Finished message which contains a MAC</td><td> </td><td class="right">   Finally, the client sends a Finished message which contains a MAC</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   over the handshake transcript (except for the server's Finished).</td><td> </td><td class="right">   over the handshake transcript (except for the server's Finished).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [[TODO: In the upcoming draft of TLS 1.3, the client's Finished will</td><td> </td><td class="right">   [[TODO: In the upcoming draft of TLS 1.3, the client's Finished will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   likely include the server's Finished.]] Once the client has</td><td> </td><td class="right">   likely include the server's Finished.]] Once the client has</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   transmitted the Finished, it can begin sending encrypted traffic to</td><td> </td><td class="right">   transmitted the Finished, it can begin sending encrypted traffic to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server.</td><td> </td><td class="right">   the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The server reads the client's Finished message and verifies the MAC.</td><td> </td><td class="right">   The server reads the client's Finished message and verifies the MAC.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If the MAC does not verify, the client terminates the handshake with</td><td> </td><td class="right">   If the MAC does not verify, the client terminates the handshake with</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   an alert.</td><td> </td><td class="right">   an alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0034" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.3.  Hello Retry Request [6.3.1.3]</td><td> </td><td class="rblock"><span class="insert">4</span>.1.3.  Hello Retry Request [6.3.1.3]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Because there are a small number of recommended groups, the</td><td> </td><td class="right">   Because there are a small number of recommended groups, the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShare will generally contain a key share for a group that</td><td> </td><td class="right">   ClientKeyShare will generally contain a key share for a group that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the server supports.  However, it is possible that the client will</td><td> </td><td class="right">   the server supports.  However, it is possible that the client will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   not send such a key share, but there may be another group that the</td><td> </td><td class="right">   not send such a key share, but there may be another group that the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   client and server jointly support.  In that case, the server MUST</td><td> </td><td class="right">   client and server jointly support.  In that case, the server MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   send a HelloRetryRequest indicating the desired group:</td><td> </td><td class="right">   send a HelloRetryRequest indicating the desired group:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         struct {</td><td> </td><td class="right">         struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             ProtocolVersion server_version;</td><td> </td><td class="right">             ProtocolVersion server_version;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             CipherSuite cipher_suite;</td><td> </td><td class="right">             CipherSuite cipher_suite;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             NamedGroup selected_group;</td><td> </td><td class="right">             NamedGroup selected_group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             Extension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">             Extension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         } HelloRetryRequest;</td><td> </td><td class="right">         } HelloRetryRequest;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In response to the HelloRetryRequest the client re-sends its</td><td> </td><td class="right">   In response to the HelloRetryRequest the client re-sends its</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientHello but with the addition of the group indicated in</td><td> </td><td class="right">   ClientHello but with the addition of the group indicated in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "selected_group".</td><td> </td><td class="right">   "selected_group".</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0035" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.4.  Zero-RTT Exchange</td><td> </td><td class="rblock"><span class="insert">4</span>.1.4.  Zero-RTT Exchange</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 allows the server to send its first application data message</td><td> </td><td class="right">   TLS 1.3 allows the server to send its first application data message</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   to the client immediately upon receiving the client's first handshake</td><td> </td><td class="right">   to the client immediately upon receiving the client's first handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   message (which the client can send upon receiving the server's SYN/</td><td> </td><td class="right">   message (which the client can send upon receiving the server's SYN/</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ACK).  However, in the basic handshake, the client is required to</td><td> </td><td class="right">   ACK).  However, in the basic handshake, the client is required to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   wait for the server's first flight before it can send to the server.</td><td> </td><td class="right">   wait for the server's first flight before it can send to the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0036" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 also includes a "Zero-RTT" feature which allows the client to</td><td> </td><td class="right">   TLS 1.3 also includes a "Zero-RTT" feature which allows the client to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   send data on its first flight to the server.</td><td> </td><td class="right">   send data on its first flight to the server.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   In order to enable this feature, in an initial handshake the server</td><td> </td><td class="right">   In order to enable this feature, in an initial handshake the server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   sends a ServerConfiguration message which contains the server's semi-</td><td> </td><td class="right">   sends a ServerConfiguration message which contains the server's semi-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   static (EC)DH key which can be used for a future handshake:</td><td> </td><td class="right">   static (EC)DH key which can be used for a future handshake:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         struct {</td><td> </td><td class="right">         struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             opaque configuration_id&lt;1..2^16-1&gt;;</td><td> </td><td class="right">             opaque configuration_id&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             uint32 expiration_date;</td><td> </td><td class="right">             uint32 expiration_date;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l7" /><small>skipping to change at</small><em> page 9, line 45</em></th><th> </th><th><a name="part-r7" /><small>skipping to change at</small><em> page 11, line 24</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             uint32 expiration_date;</td><td> </td><td class="right">             uint32 expiration_date;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             NamedGroup group;</td><td> </td><td class="right">             NamedGroup group;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             opaque server_key&lt;1..2^16-1&gt;;</td><td> </td><td class="right">             opaque server_key&lt;1..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             EarlyDataType early_data_type;</td><td> </td><td class="right">             EarlyDataType early_data_type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">             ConfigurationExtension extensions&lt;0..2^16-1&gt;;</td><td> </td><td class="right">             ConfigurationExtension extensions&lt;0..2^16-1&gt;;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">         } ServerConfiguration;</td><td> </td><td class="right">         } ServerConfiguration;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The group and server_key fields contain the server's (EC)DH key and</td><td> </td><td class="right">   The group and server_key fields contain the server's (EC)DH key and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   the early_data_type field is used to indicate what data can be sent</td><td> </td><td class="right">   the early_data_type field is used to indicate what data can be sent</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   in zero-RTT.  Because client authentication is forbidden in TCPINC-</td><td> </td><td class="right">   in zero-RTT.  Because client authentication is forbidden in TCPINC-</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0037" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   uses of TLS 1.3 (see Section <span class="delete">3</span>.3), the only valid value here is</td><td> </td><td class="rblock">   uses of TLS 1.3 (see Section <span class="insert">4</span>.3), the only valid value here is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   "early_data", indicating that the client can send data in 0-RTT.</td><td> </td><td class="right">   "early_data", indicating that the client can send data in 0-RTT.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0038" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">When</span> a ServerConfiguration is <span class="delete">available,</span> the client <span class="delete">can send</span> an</td><td> </td><td class="rblock">   <span class="insert">In</span> a <span class="insert">future connection, a client MAY send 0-RTT data only if the</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   EarlyDataIndication extension in its ClientHello and <span class="delete">then</span> start</td><td> </td><td class="rblock"><span class="insert">   following three conditions obtain:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   sending data immediately, as shown below.</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  It has been specifically configured to do so (see Section 6).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  A</span> ServerConfiguration is <span class="insert">available.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  The server supplied a nonce in its SYN/ACK suboption [[TODO: Work</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      out how to make this work with TFO if at all.]]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In this case,</span> the client <span class="insert">sends</span> an EarlyDataIndication extension in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   its ClientHello and <span class="insert">can</span> start sending data immediately, as shown</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   below.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          Client                                               Server</td><td> </td><td class="right">          Client                                               Server</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          ClientHello</td><td> </td><td class="right">          ClientHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            + ClientKeyShare</td><td> </td><td class="right">            + ClientKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">            + EarlyDataIndication</td><td> </td><td class="right">            + EarlyDataIndication</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0039" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">            + TCPENOTranscript</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (EncryptedExtensions)</td><td> </td><td class="right">          (EncryptedExtensions)</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          (Application Data)        --------&gt;</td><td> </td><td class="right">          (Application Data)        --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                          ServerHello</td><td> </td><td class="right">                                                          ServerHello</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                + EarlyDataIndication</td><td> </td><td class="right">                                                + EarlyDataIndication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                       ServerKeyShare</td><td> </td><td class="right">                                                       ServerKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                {EncryptedExtensions}</td><td> </td><td class="right">                                                {EncryptedExtensions}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                               {ServerConfiguration*}</td><td> </td><td class="right">                                               {ServerConfiguration*}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                        {Certificate}</td><td> </td><td class="right">                                                        {Certificate}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                                  {CertificateVerify}</td><td> </td><td class="right">                                                  {CertificateVerify}</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                                    &lt;--------              {Finished}</td><td> </td><td class="right">                                    &lt;--------              {Finished}</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0040" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                                    &lt;--------      [Application Data]</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          {Finished}                --------&gt;</td><td> </td><td class="right">          {Finished}                --------&gt;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">          [Application Data]        &lt;-------&gt;      [Application Data]</td><td> </td><td class="right">          [Application Data]        &lt;-------&gt;      [Application Data]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">               () Indicates messages protected using keys</td><td> </td><td class="right">               () Indicates messages protected using keys</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">                  derived from the static secret.</td><td> </td><td class="right">                  derived from the static secret.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0041" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">          Figure <span class="delete">2</span>: Message flow for a zero round trip handshake</td><td> </td><td class="rblock">          Figure <span class="insert">4</span>: Message flow for a zero round trip handshake</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0042" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   IMPORTANT NOTE: TLS 1.3 Zero-RTT <span class="delete">data is inherently replayable (see</span></td><td> </td><td class="rblock">   IMPORTANT NOTE: TLS 1.3 Zero-RTT <span class="insert">does not provide PFS and therefore</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   the note in [I-D.ietf-tls-tls13] Section 6.2.2).  If</span> only <span class="delete">passive</span></td><td> </td><td class="rblock"><span class="insert">   MUST</span> only be <span class="insert">used when explicitly configured.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   threat models are relevant, this issue becomes less important.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   However, if applications are performing an external channel binding</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   using the session id to prevent active attack, then care must</span> be</td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">taken to prevent this form of attack.  See Section 6.2.2 of</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [I-D.ietf-tls-tls13] for more information on this topic.  [[OPEN</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ISSUE: can we use data from the TCP SYN as anti-replay stuff.]]</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0043" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.1.5.</span>  Key Schedule</td><td> </td><td class="rblock">   <span class="insert">Note: TLS 1.3 Zero-RTT data is inherently replayable (see the note in</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [I-D.ietf-tls-tls13] Section 6.2.2).  However, because the client and</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   server have already exchanged data in the _TCP_ handshake, this data</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   can be used to provide anti-replay for a 0-RTT mode TLS handshake via</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the TCPENOTranscript extension.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">4.1.5.</span>  Key Schedule</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.3 derives its traffic keys from two input keying material</td><td> </td><td class="right">   TLS 1.3 derives its traffic keys from two input keying material</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   values:</td><td> </td><td class="right">   values:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Ephemeral Secret (ES): A secret which is derived from ClientKeyShare</td><td> </td><td class="right">   Ephemeral Secret (ES): A secret which is derived from ClientKeyShare</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and ServerKeyShare.</td><td> </td><td class="right">   and ServerKeyShare.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Static Secret (SS): A secret which which is derived from</td><td> </td><td class="right">   Static Secret (SS): A secret which which is derived from</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   ClientKeyShare and either ServerKeyShare (in the 1-RTT case) or the</td><td> </td><td class="right">   ClientKeyShare and either ServerKeyShare (in the 1-RTT case) or the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   public key in the ServerConfiguration (in the 0-RTT case).</td><td> </td><td class="right">   public key in the ServerConfiguration (in the 0-RTT case).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The handshake is encrypted under keys derived from ES.  The ordinary</td><td> </td><td class="right">   The handshake is encrypted under keys derived from ES.  The ordinary</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   traffic keys are derived from the combination of ES and SS.  The</td><td> </td><td class="right">   traffic keys are derived from the combination of ES and SS.  The</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   0-RTT traffic keys are derived solely from ES and therefore have</td><td> </td><td class="right">   0-RTT traffic keys are derived solely from ES and therefore have</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0044" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   limited forward security.  All key derivation is done using HKDF</td><td> </td><td class="rblock">   limited forward security.  All key derivation is done using <span class="insert">the</span> HKDF</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   [RFC5869].</td><td> </td><td class="rblock">   <span class="insert">key-derivation algorithm</span> [RFC5869].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0045" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.1.6.  Record Protection</td><td> </td><td class="rblock"><span class="insert">4</span>.1.6.  Record Protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the TLS handshake has completed, all data is protected as a</td><td> </td><td class="right">   Once the TLS handshake has completed, all data is protected as a</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   series of TLS Records.</td><td> </td><td class="right">   series of TLS Records.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       struct {</td><td> </td><td class="right">       struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           ContentType opaque_type = application_data(23); /* see fragment.type */</td><td> </td><td class="right">           ContentType opaque_type = application_data(23); /* see fragment.type */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           ProtocolVersion record_version = { 3, 1 };    /* TLS v1.x */</td><td> </td><td class="right">           ProtocolVersion record_version = { 3, 1 };    /* TLS v1.x */</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           uint16 length;</td><td> </td><td class="right">           uint16 length;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           aead-ciphered struct {</td><td> </td><td class="right">           aead-ciphered struct {</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              opaque content[TLSPlaintext.length];</td><td> </td><td class="right">              opaque content[TLSPlaintext.length];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              ContentType type;</td><td> </td><td class="right">              ContentType type;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              uint8 zeros[length_of_padding];</td><td> </td><td class="right">              uint8 zeros[length_of_padding];</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">           } fragment;</td><td> </td><td class="right">           } fragment;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       } TLSCiphertext;</td><td> </td><td class="right">       } TLSCiphertext;</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0046" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   Each record is encrypted with an <span class="delete">AEAD</span> cipher with the following</td><td> </td><td class="rblock">   Each record is encrypted with an <span class="insert">Authenticated Encryption with</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   parameters:</td><td> </td><td class="rblock"><span class="insert">   Additional Data (AEAD)</span> cipher with the following parameters:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  The AEAD nonce is constructed by generating a per-connection nonce</td><td> </td><td class="right">   o  The AEAD nonce is constructed by generating a per-connection nonce</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0047" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      mask of length max(8 bytes, N_MIN) for the AEAD algorithm <span class="delete">(see</span></td><td> </td><td class="rblock">      mask of length max(8 bytes, N_MIN) for the AEAD algorithm <span class="insert">(N_MIN</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      [RFC5116] Section 4) and XORing it with the <span class="delete">record</span> sequence number</td><td> </td><td class="rblock"><span class="insert">      is the minimum nonce size defined in</span> [RFC5116] Section 4) and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">      (left-padded with <span class="delete">zeroed).</span></td><td> </td><td class="rblock">      XORing it with the sequence number <span class="insert">of the TLS record</span> (left-padded</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">      with <span class="insert">zeroes).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  The additional data is the sequence number + the TLS version</td><td> </td><td class="right">   o  The additional data is the sequence number + the TLS version</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      number.</td><td> </td><td class="right">      number.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The record data MAY BE padded with zeros to the right.  Because the</td><td> </td><td class="right">   The record data MAY BE padded with zeros to the right.  Because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0048" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   content type value is always non-zero, the padding is removed by</td><td> </td><td class="rblock">   content type <span class="insert">byte </span>value is always non-zero, the padding is removed by</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   removing bytes from the right until a non-zero byte is encountered.</td><td> </td><td class="right">   removing bytes from the right until a non-zero byte is encountered.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0049" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.2.  TLS 1.2 Profile</td><td> </td><td class="rblock"><span class="insert">4</span>.2.  TLS 1.2 Profile</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations MUST implement and require the TLS Extended Master</td><td> </td><td class="right">   Implementations MUST implement and require the TLS Extended Master</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Secret Extension [I-D.ietf-tls-session-hash] and MUST NOT negotiate</td><td> </td><td class="right">   Secret Extension [I-D.ietf-tls-session-hash] and MUST NOT negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   versions of TLS prior to TLS 1.2.  Implementations MUST NOT negotiate</td><td> </td><td class="right">   versions of TLS prior to TLS 1.2.  Implementations MUST NOT negotiate</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   non-AEAD cipher suites and MUST use only PFS cipher suites with a key</td><td> </td><td class="right">   non-AEAD cipher suites and MUST use only PFS cipher suites with a key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   of at least 2048 bits (finite field) or 256 bites (elliptic curve).</td><td> </td><td class="right">   of at least 2048 bits (finite field) or 256 bites (elliptic curve).</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TLS 1.2 implementations MUST NOT initiate renegotiation and MUST</td><td> </td><td class="right">   TLS 1.2 implementations MUST NOT initiate renegotiation and MUST</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   respond to renegotiation with a fatal "no_renegotiation" alert.</td><td> </td><td class="right">   respond to renegotiation with a fatal "no_renegotiation" alert.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0050" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3</span>.3.  Deprecated Features</td><td> </td><td class="rblock"><span class="insert">4</span>.3.  Deprecated Features</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   When TLS is used with TCPINC, a number of TLS features MUST NOT be</td><td> </td><td class="right">   When TLS is used with TCPINC, a number of TLS features MUST NOT be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   used, including:</td><td> </td><td class="right">   used, including:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  TLS certificate-based client authentication</td><td> </td><td class="right">   o  TLS certificate-based client authentication</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0051" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   o  Session resumption <span class="delete">[????]</span></td><td> </td><td class="rblock">   o  Session resumption</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.4.  Session ID</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0052" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   <span class="delete">TCP-ENO Section 4.1 defines a session ID feature (not to be confused</span></td><td> </td><td class="rblock">   <span class="insert">These features have only minimal advantage</span> in <span class="insert">this context</span> and</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   with TLS Session IDs).  When the protocol</span> in <span class="delete">use is TLS, the session</span></td><td> </td><td class="rblock">   <span class="insert">interfere</span> with <span class="insert">offering a reduced profile.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   ID is computed via a TLS Exporter [RFC5705] using the Exporter Label</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   [[TBD]]</span> and with <span class="delete">the "context" input being the TCP-ENO negotiation</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   transcript defined in [I-D.bittau-tcpinc-tcpeno] Section 3.4.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0053" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">3.5</span>.  Cryptographic Algorithms</td><td> </td><td class="rblock"><span class="insert">4.4</span>.  Cryptographic Algorithms</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations of this specification MUST implement the following</td><td> </td><td class="right">   Implementations of this specification MUST implement the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher suite:</td><td> </td><td class="right">   cipher suite:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</td><td> </td><td class="right">       TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   These cipher suites MUST support both digital signatures and key</td><td> </td><td class="right">   These cipher suites MUST support both digital signatures and key</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   exchange with secp256r1 (NIST P-256) and SHOULD support key agrement</td><td> </td><td class="right">   exchange with secp256r1 (NIST P-256) and SHOULD support key agrement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   with X25519 [I-D.irtf-cfrg-curves].</td><td> </td><td class="right">   with X25519 [I-D.irtf-cfrg-curves].</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Implementations of this specification SHOULD implement the following</td><td> </td><td class="right">   Implementations of this specification SHOULD implement the following</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   cipher suites:</td><td> </td><td class="right">   cipher suites:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</td><td> </td><td class="right">       TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">       TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td><td> </td><td class="right">       TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0054" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">4.  Suboption Definition</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete"></span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">   This document uses a one byte TCP-ENO suboption.  See Section 8.</span></td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">5.  Transport Integrity</td><td> </td><td class="right">5.  Transport Integrity</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The basic operational mode defined by TCP-TLS protects only the</td><td> </td><td class="right">   The basic operational mode defined by TCP-TLS protects only the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application layer content, but not the TCP segment metadata.  Upon</td><td> </td><td class="right">   application layer content, but not the TCP segment metadata.  Upon</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   receiving a packet, implementations MUST first check the TCP checksum</td><td> </td><td class="right">   receiving a packet, implementations MUST first check the TCP checksum</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   and discard corrupt packets without presenting them to TLS.  If the</td><td> </td><td class="right">   and discard corrupt packets without presenting them to TLS.  If the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP checksum passes but TLS integrity fails, the connection MUST be</td><td> </td><td class="right">   TCP checksum passes but TLS integrity fails, the connection MUST be</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   torn down.</td><td> </td><td class="right">   torn down.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Thus, TCP-TLS provides automatic security for the content, but not</td><td> </td><td class="right">   Thus, TCP-TLS provides automatic security for the content, but not</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   protection against DoS-style attacks.  For instance, attackers will</td><td> </td><td class="right">   protection against DoS-style attacks.  For instance, attackers will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   be able to inject RST packets, bogus application segments, etc.,</td><td> </td><td class="right">   be able to inject RST packets, bogus application segments, etc.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   regardless of whether TLS authentication is used.  Because the</td><td> </td><td class="right">   regardless of whether TLS authentication is used.  Because the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application data is TLS protected, this will not result in the</td><td> </td><td class="right">   application data is TLS protected, this will not result in the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   application receiving bogus data, but it will constitute a DoS on the</td><td> </td><td class="right">   application receiving bogus data, but it will constitute a DoS on the</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   connection.</td><td> </td><td class="right">   connection.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   This attack could be countered by using TCP-TLS in combination with</td><td> </td><td class="right">   This attack could be countered by using TCP-TLS in combination with</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0055" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   TCP-AO [RFC5925], using <span class="delete">ALPN</span> to negotiate the use of AO.  [[OPEN</td><td> </td><td class="rblock">   TCP-AO [RFC5925], using <span class="insert">Application-Layer Protocol Negotiation (ALPN)</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   ISSUE: Is this something we want?  Maybe in a separate</td><td> </td><td class="rblock"><span class="insert">   [RFC7301]</span> to negotiate the use of AO.  [[OPEN ISSUE: Is this</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   specification.]]</td><td> </td><td class="rblock">   something we want?  Maybe in a separate specification.]]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0056" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">6.  Implementation <span class="delete">Options</span></td><td> </td><td class="rblock">6.  <span class="insert">API Considerations</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Needed here:</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  How to configure 0-RTT and send 0-RTT data (some sort of sockopt).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  When is the session-id available (post-connect() completion).</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   o  How to indicate that the certificate should be validated.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">7.</span>  Implementation <span class="insert">Considerations</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   There are two primary implementation options for TCP-TLS:</td><td> </td><td class="right">   There are two primary implementation options for TCP-TLS:</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Implement all of TCP-TLS in the operating system kernel.</td><td> </td><td class="right">   o  Implement all of TCP-TLS in the operating system kernel.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   o  Implement just the TCP-TLS negotiation option in the operating</td><td> </td><td class="right">   o  Implement just the TCP-TLS negotiation option in the operating</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      system kernel with an interface to tell the application that TCP-</td><td> </td><td class="right">      system kernel with an interface to tell the application that TCP-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      TLS has been negotiated and therefore that the application must</td><td> </td><td class="right">      TLS has been negotiated and therefore that the application must</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">      negotiate TLS.</td><td> </td><td class="right">      negotiate TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The former option obviously achieves easier deployment for</td><td> </td><td class="right">   The former option obviously achieves easier deployment for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   applications, which don't have to do anything, but is more effort for</td><td> </td><td class="right">   applications, which don't have to do anything, but is more effort for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   kernel developers and requires a wider interface to the kernel to</td><td> </td><td class="right">   kernel developers and requires a wider interface to the kernel to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   configure the TLS stack.  The latter option is inherently more</td><td> </td><td class="right">   configure the TLS stack.  The latter option is inherently more</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   flexible but does not provide as immediate transparent deployment.</td><td> </td><td class="right">   flexible but does not provide as immediate transparent deployment.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   It is also possible for systems to offer both options.</td><td> </td><td class="right">   It is also possible for systems to offer both options.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0057" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">7</span>.  NAT/Firewall considerations</td><td> </td><td class="rblock"><span class="insert">8</span>.  NAT/Firewall considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If use of TLS is negotiated, the data sent over TCP simply is TLS</td><td> </td><td class="right">   If use of TLS is negotiated, the data sent over TCP simply is TLS</td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0058" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">   data in compliance with <span class="delete">{{RFC5246}.</span> Thus it is extremely likely to</td><td> </td><td class="rblock">   data in compliance with <span class="insert">[RFC5246]. </span> Thus it is extremely likely to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   pass through NATs, firewalls, etc.  The only kind of middlebox that</td><td> </td><td class="right">   pass through NATs, firewalls, etc.  The only kind of middlebox that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is likely to cause a problem is one which does protocol enforcement</td><td> </td><td class="right">   is likely to cause a problem is one which does protocol enforcement</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   that blocks TLS on arbitrary (non-443) ports but _also_ passes</td><td> </td><td class="right">   that blocks TLS on arbitrary (non-443) ports but _also_ passes</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unknown TCP options.  Although no doubt such devices do exist,</td><td> </td><td class="right">   unknown TCP options.  Although no doubt such devices do exist,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   because this is a common scenario, a client machine should be able to</td><td> </td><td class="right">   because this is a common scenario, a client machine should be able to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   probe to determine if it is behind such a device relatively readily.</td><td> </td><td class="right">   probe to determine if it is behind such a device relatively readily.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0059" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">8</span>.  IANA Considerations</td><td> </td><td class="rblock"><span class="insert">9</span>.  IANA Considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IANA [shall register/has registered] the TCP-ENO suboption XX for</td><td> </td><td class="right">   IANA [shall register/has registered] the TCP-ENO suboption XX for</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   TCP-TLS.</td><td> </td><td class="right">   TCP-TLS.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   IANA [shall register/has registered] the ALPN code point "tcpao" to</td><td> </td><td class="right">   IANA [shall register/has registered] the ALPN code point "tcpao" to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   indicate the use of TCP-TLS with TCP-AO.</td><td> </td><td class="right">   indicate the use of TCP-TLS with TCP-AO.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0060" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"><span class="delete">9</span>.  Security Considerations</td><td> </td><td class="rblock"><span class="insert">10</span>.  Security Considerations</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   The mechanisms in this document are inherently vulnerable to active</td><td> </td><td class="right">   The mechanisms in this document are inherently vulnerable to active</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   attack because an attacker can remove the TCP-TLS option, thus</td><td> </td><td class="right">   attack because an attacker can remove the TCP-TLS option, thus</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   downgrading you to ordinary TCP.  Even when TCP-AO is used, all that</td><td> </td><td class="right">   downgrading you to ordinary TCP.  Even when TCP-AO is used, all that</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   is being provided is continuity of authentication from the initial</td><td> </td><td class="right">   is being provided is continuity of authentication from the initial</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   handshake.  If some sort of external authentication mechanism was</td><td> </td><td class="right">   handshake.  If some sort of external authentication mechanism was</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   provided or certificates are used, then you might get some protection</td><td> </td><td class="right">   provided or certificates are used, then you might get some protection</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   against active attack.</td><td> </td><td class="right">   against active attack.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Once the TCP-TLS option has been negotiated, then the connection is</td><td> </td><td class="right">   Once the TCP-TLS option has been negotiated, then the connection is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l8" /><small>skipping to change at</small><em> page 14, line 32</em></th><th> </th><th><a name="part-r8" /><small>skipping to change at</small><em> page 16, line 32</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   while data integrity is provided, the connection is not resistant to</td><td> </td><td class="right">   while data integrity is provided, the connection is not resistant to</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   DoS attacks intended to terminate it.</td><td> </td><td class="right">   DoS attacks intended to terminate it.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   If TCP-AO is used, then any bogus packets injected by an attacker</td><td> </td><td class="right">   If TCP-AO is used, then any bogus packets injected by an attacker</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   will be rejected by the TCP-AO integrity check and therefore will</td><td> </td><td class="right">   will be rejected by the TCP-AO integrity check and therefore will</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   never reach the TLS layer.  Thus, in this case, the connection is</td><td> </td><td class="right">   never reach the TLS layer.  Thus, in this case, the connection is</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   also resistant to DoS attacks, provided that endpoints require</td><td> </td><td class="right">   also resistant to DoS attacks, provided that endpoints require</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   integrity protection for RST packets.  If endpoints accept</td><td> </td><td class="right">   integrity protection for RST packets.  If endpoints accept</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   unauthenticated RST, then no DoS protection is provided.</td><td> </td><td class="right">   unauthenticated RST, then no DoS protection is provided.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0061" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">1<span class="delete">0</span>.  References</td><td> </td><td class="rblock">1<span class="insert">1</span>.  References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0062" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">1<span class="delete">0</span>.1.  Normative References</td><td> </td><td class="rblock">1<span class="insert">1</span>.1.  Normative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.bittau-tcpinc-tcpeno]</td><td> </td><td class="right">   [I-D.bittau-tcpinc-tcpeno]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Bittau, A., Boneh, D., Giffin, D., Handley, M., Mazieres,</td><td> </td><td class="right">              Bittau, A., Boneh, D., Giffin, D., Handley, M., Mazieres,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              D., and E. Smith, "TCP-ENO: Encryption Negotiation</td><td> </td><td class="right">              D., and E. Smith, "TCP-ENO: Encryption Negotiation</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Option", draft-bittau-tcpinc-tcpeno-02 (work in progress),</td><td> </td><td class="right">              Option", draft-bittau-tcpinc-tcpeno-02 (work in progress),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              September 2015.</td><td> </td><td class="right">              September 2015.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.ietf-tls-applayerprotoneg]</td><td> </td><td class="right">   [I-D.ietf-tls-applayerprotoneg]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Friedl, S., Popov, A., Langley, A., and S. Emile,</td><td> </td><td class="right">              Friedl, S., Popov, A., Langley, A., and S. Emile,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              "Transport Layer Security (TLS) Application Layer Protocol</td><td> </td><td class="right">              "Transport Layer Security (TLS) Application Layer Protocol</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l9" /><small>skipping to change at</small><em> page 16, line 5</em></th><th> </th><th><a name="part-r9" /><small>skipping to change at</small><em> page 18, line 5</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5925]  Touch, J., Mankin, A., and R. Bonica, "The TCP</td><td> </td><td class="right">   [RFC5925]  Touch, J., Mankin, A., and R. Bonica, "The TCP</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Authentication Option", RFC 5925, DOI 10.17487/RFC5925,</td><td> </td><td class="right">              Authentication Option", RFC 5925, DOI 10.17487/RFC5925,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              June 2010, &lt;http://www.rfc-editor.org/info/rfc5925&gt;.</td><td> </td><td class="right">              June 2010, &lt;http://www.rfc-editor.org/info/rfc5925&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC7250]  Wouters, P., Ed., Tschofenig, H., Ed., Gilmore, J.,</td><td> </td><td class="right">   [RFC7250]  Wouters, P., Ed., Tschofenig, H., Ed., Gilmore, J.,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Weiler, S., and T. Kivinen, "Using Raw Public Keys in</td><td> </td><td class="right">              Weiler, S., and T. Kivinen, "Using Raw Public Keys in</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Transport Layer Security (TLS) and Datagram Transport</td><td> </td><td class="right">              Transport Layer Security (TLS) and Datagram Transport</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Layer Security (DTLS)", RFC 7250, DOI 10.17487/RFC7250,</td><td> </td><td class="right">              Layer Security (DTLS)", RFC 7250, DOI 10.17487/RFC7250,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              June 2014, &lt;http://www.rfc-editor.org/info/rfc7250&gt;.</td><td> </td><td class="right">              June 2014, &lt;http://www.rfc-editor.org/info/rfc7250&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0063" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock">1<span class="delete">0</span>.2.  Informative References</td><td> </td><td class="rblock">1<span class="insert">1</span>.2.  Informative References</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.bittau-tcp-crypt]</td><td> </td><td class="right">   [I-D.bittau-tcp-crypt]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Bittau, A., Boneh, D., Hamburg, M., Handley, M., Mazieres,</td><td> </td><td class="right">              Bittau, A., Boneh, D., Hamburg, M., Handley, M., Mazieres,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              D., and Q. Slack, "Cryptographic protection of TCP Streams</td><td> </td><td class="right">              D., and Q. Slack, "Cryptographic protection of TCP Streams</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              (tcpcrypt)", draft-bittau-tcp-crypt-04 (work in progress),</td><td> </td><td class="right">              (tcpcrypt)", draft-bittau-tcp-crypt-04 (work in progress),</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              February 2014.</td><td> </td><td class="right">              February 2014.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [I-D.ietf-tls-falsestart]</td><td> </td><td class="right">   [I-D.ietf-tls-falsestart]</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Langley, A., Modadugu, N., and B. Moeller, "Transport</td><td> </td><td class="right">              Langley, A., Modadugu, N., and B. Moeller, "Transport</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              Layer Security (TLS) False Start", draft-ietf-tls-</td><td> </td><td class="right">              Layer Security (TLS) False Start", draft-ietf-tls-</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr bgcolor="gray" ><td></td><th><a name="part-l10" /><small>skipping to change at</small><em> page 16, line 27</em></th><th> </th><th><a name="part-r10" /><small>skipping to change at</small><em> page 18, line 27</em></th><td></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC5929]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings</td><td> </td><td class="right">   [RFC5929]  Altman, J., Williams, N., and L. Zhu, "Channel Bindings</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              for TLS", RFC 5929, DOI 10.17487/RFC5929, July 2010,</td><td> </td><td class="right">              for TLS", RFC 5929, DOI 10.17487/RFC5929, July 2010,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://www.rfc-editor.org/info/rfc5929&gt;.</td><td> </td><td class="right">              &lt;http://www.rfc-editor.org/info/rfc5929&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   [RFC6919]  Barnes, R., Kent, S., and E. Rescorla, "Further Key Words</td><td> </td><td class="right">   [RFC6919]  Barnes, R., Kent, S., and E. Rescorla, "Further Key Words</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              for Use in RFCs to Indicate Requirement Levels", RFC 6919,</td><td> </td><td class="right">              for Use in RFCs to Indicate Requirement Levels", RFC 6919,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              DOI 10.17487/RFC6919, April 2013,</td><td> </td><td class="right">              DOI 10.17487/RFC6919, April 2013,</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">              &lt;http://www.rfc-editor.org/info/rfc6919&gt;.</td><td> </td><td class="right">              &lt;http://www.rfc-editor.org/info/rfc6919&gt;.</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td><a name="diff0064" /></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              "Transport Layer Security (TLS) Application-Layer Protocol</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              July 2014, &lt;http://www.rfc-editor.org/info/rfc7301&gt;.</span></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">Author's Address</td><td> </td><td class="right">Author's Address</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Eric Rescorla</td><td> </td><td class="right">   Eric Rescorla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   Mozilla</td><td> </td><td class="right">   Mozilla</td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno" valign="top"></td></tr>
      <tr><td class="lineno" valign="top"></td><td class="left">   EMail: ekr@rtfm.com</td><td> </td><td class="right">   EMail: ekr@rtfm.com</td><td class="lineno" valign="top"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr bgcolor="gray"><th colspan="5" align="center"><a name="end">&nbsp;End of changes. 64 change blocks.&nbsp;</a></th></tr>
     <tr class="stats"><td></td><th><i>131 lines changed or deleted</i></th><th><i> </i></th><th><i>215 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.34. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
